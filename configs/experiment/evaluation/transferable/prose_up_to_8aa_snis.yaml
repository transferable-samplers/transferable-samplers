# @package _global_

defaults:
  - override /model: normalizing_flow
  - override /model/net: prose
  - override /data: transferable/up_to_8aa
  - override /trainer: gpu

state_dict_hf_path: transferable/prose_up_to_8aa.pth

model:
  sampler:
    _target_: src.models.samplers.snis_sampler.SNISSampler
    num_samples: 10_000
    batch_size: 2000
    logit_clip_filter_pct: 0.2  # 0.002 * 100 to convert to percentage
  ema_decay: 0.0

data:
  batch_size: 128
  num_eval_samples: 10_000

trainer:
  limit_test_batches: 1
  limit_val_batches: 1
